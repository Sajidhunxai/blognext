"use strict";(()=>{var e={};e.id=6668,e.ids=[6668],e.modules={53524:e=>{e.exports=require("@prisma/client")},72934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},27790:e=>{e.exports=require("assert")},78893:e=>{e.exports=require("buffer")},84770:e=>{e.exports=require("crypto")},17702:e=>{e.exports=require("events")},32615:e=>{e.exports=require("http")},35240:e=>{e.exports=require("https")},86624:e=>{e.exports=require("querystring")},17360:e=>{e.exports=require("url")},21764:e=>{e.exports=require("util")},71568:e=>{e.exports=require("zlib")},8262:(e,r,o)=>{o.r(r),o.d(r,{originalPathname:()=>h,patchFetch:()=>v,requestAsyncStorage:()=>f,routeModule:()=>C,serverHooks:()=>g,staticGenerationAsyncStorage:()=>m});var t={};o.r(t),o.d(t,{GET:()=>c,PUT:()=>p});var i=o(49303),n=o(88716),a=o(60670),s=o(75571),l=o(90455),d=o(72331),u=o(79656);async function c(e){try{if(!d._)return(0,u.j)({error:"Prisma client not initialized"},500);if(!("settings"in d._))return console.error("Settings model not found. Run: npx prisma generate && restart server"),(0,u.j)({error:"Settings model not found",hint:"Run 'npx prisma generate' and restart the dev server"},500);let e=await d._.settings.findFirst();e||(e=await d._.settings.create({data:{siteName:"PKR Games",headerMenu:["Home","Apps","Games","Casinos"],footerLinks:[],socialMedia:{facebook:"",twitter:"",instagram:"",youtube:"",pinterest:"",telegram:""},heroTitle:null,heroSubtitle:"",backgroundColor:"#111827",textColor:"#ffffff",buttonColor:"#dc2626",buttonTextColor:"#ffffff",linkColor:"#3b82f6",successColor:"#16a34a",errorColor:"#dc2626",warningColor:"#f59e0b",infoColor:"#3b82f6"}}));let r=(0,u.D)(e);return(0,u.j)(r)}catch(e){return(0,u.j)({error:e.message||"Failed to fetch settings"},500)}}async function p(e){let r=await (0,s.getServerSession)(l.L);if(!r||"admin"!==r.user.role)return(0,u.j)({error:"Unauthorized"},401);try{if(!d._)return(0,u.j)({error:"Prisma client not initialized"},500);if(!("settings"in d._))return console.error("Settings model not found. Run: npx prisma generate && restart server"),(0,u.j)({error:"Settings model not found",hint:"Run 'npx prisma generate' and restart the dev server"},500);let r=await e.json(),o=await d._.settings.findFirst(),t={};void 0!==r.siteName&&(t.siteName=r.siteName),void 0!==r.logo&&(t.logo=r.logo),void 0!==r.favicon&&(t.favicon=r.favicon),void 0!==r.headerMenu&&(t.headerMenu=r.headerMenu),void 0!==r.footerLinks&&(t.footerLinks=r.footerLinks),void 0!==r.socialMedia&&(t.socialMedia=r.socialMedia),void 0!==r.heroTitle&&(t.heroTitle=r.heroTitle),void 0!==r.heroSubtitle&&(t.heroSubtitle=r.heroSubtitle),void 0!==r.heroBackground&&(t.heroBackground=r.heroBackground),void 0!==r.enableComments&&(t.enableComments=r.enableComments),void 0!==r.primaryColor&&(t.primaryColor=r.primaryColor),void 0!==r.secondaryColor&&(t.secondaryColor=r.secondaryColor),void 0!==r.backgroundColor&&(t.backgroundColor=r.backgroundColor),void 0!==r.textColor&&(t.textColor=r.textColor),void 0!==r.buttonColor&&(t.buttonColor=r.buttonColor),void 0!==r.buttonTextColor&&(t.buttonTextColor=r.buttonTextColor),void 0!==r.linkColor&&(t.linkColor=r.linkColor),void 0!==r.successColor&&(t.successColor=r.successColor),void 0!==r.errorColor&&(t.errorColor=r.errorColor),void 0!==r.warningColor&&(t.warningColor=r.warningColor),void 0!==r.infoColor&&(t.infoColor=r.infoColor),void 0!==r.headerScript&&(t.headerScript=r.headerScript),void 0!==r.footerScript&&(t.footerScript=r.footerScript),void 0!==r.headerCSS&&(t.headerCSS=r.headerCSS),void 0!==r.footerCSS&&(t.footerCSS=r.footerCSS),o=o?await d._.settings.update({where:{id:o.id},data:t}):await d._.settings.create({data:{siteName:r.siteName||"PKR Games",logo:r.logo||"",favicon:r.favicon||"",headerMenu:r.headerMenu||[],footerLinks:r.footerLinks||[],socialMedia:r.socialMedia||{},heroTitle:r.heroTitle||null,heroSubtitle:r.heroSubtitle||"",heroBackground:r.heroBackground||"",enableComments:void 0===r.enableComments||r.enableComments,primaryColor:r.primaryColor||"#dc2626",secondaryColor:r.secondaryColor||"#16a34a",backgroundColor:r.backgroundColor||"#111827",textColor:r.textColor||"#ffffff",buttonColor:r.buttonColor||"#dc2626",buttonTextColor:r.buttonTextColor||"#ffffff",linkColor:r.linkColor||"#3b82f6",successColor:r.successColor||"#16a34a",errorColor:r.errorColor||"#dc2626",warningColor:r.warningColor||"#f59e0b",infoColor:r.infoColor||"#3b82f6",headerScript:r.headerScript||null,footerScript:r.footerScript||null,headerCSS:r.headerCSS||null,footerCSS:r.footerCSS||null}});let i=(0,u.D)(o);return(0,u.j)(i)}catch(e){return(0,u.j)({error:e.message||"Failed to update settings"},500)}}let C=new i.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/settings/route",pathname:"/api/settings",filename:"route",bundlePath:"app/api/settings/route"},resolvedPagePath:"/Users/hunxai/apkapp/app/api/settings/route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:f,staticGenerationAsyncStorage:m,serverHooks:g}=C,h="/api/settings/route";function v(){return(0,a.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:m})}},79656:(e,r,o)=>{o.d(r,{D:()=>function e(r){if("object"!=typeof r||null===r)return r;let o=["secret","password","token","key","apiSecret","apiKey"],t={...r};for(let r in t)o.some(e=>r.toLowerCase().includes(e))?t[r]="***REDACTED***":"object"==typeof t[r]&&(t[r]=e(t[r]));return t},j:()=>i});var t=o(87070);function i(e,r=200){let o=t.NextResponse.json(e,{status:r});return o.headers.set("X-Content-Type-Options","nosniff"),o.headers.set("X-Frame-Options","DENY"),o.headers.set("X-XSS-Protection","1; mode=block"),o.headers.set("Cache-Control","no-store, no-cache, must-revalidate, private"),o.headers.set("Pragma","no-cache"),o.headers.set("Expires","0"),o}},90455:(e,r,o)=>{o.d(r,{L:()=>s});var t=o(53797),i=o(72331),n=o(42023),a=o.n(n);let s={secret:process.env.NEXTAUTH_SECRET,providers:[(0,t.Z)({name:"Credentials",credentials:{email:{label:"Email",type:"email"},password:{label:"Password",type:"password"}},async authorize(e){if(!e?.email||!e?.password)return null;try{let r=await i._.user.findUnique({where:{email:e.email}});if(!r||"admin"!==r.role||!await a().compare(e.password,r.password))return null;return{id:r.id,email:r.email,name:r.name,role:r.role}}catch(e){return console.error("Auth error:",e),null}}})],session:{strategy:"jwt"},pages:{signIn:"/login"},callbacks:{jwt:async({token:e,user:r})=>(r&&(e.role=r.role),e),session:async({session:e,token:r})=>(e.user&&(e.user.id=r.sub,e.user.role=r.role),e)}}},72331:(e,r,o)=>{o.d(r,{_:()=>i});var t=o(53524);let i=globalThis.prisma??new t.PrismaClient}};var r=require("../../../webpack-runtime.js");r.C(e);var o=e=>r(r.s=e),t=r.X(0,[8948,7313,5972],()=>o(8262));module.exports=t})();